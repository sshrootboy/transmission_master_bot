version: '3.8'

services:
  transmission:
    image: linuxserver/transmission:latest
    container_name: transmission
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Europe/Moscow}
    volumes:
      - ${TRANSMISSION_CONFIG_PATH:-./transmission/config}:/config
      - ${TRANSMISSION_DOWNLOADS_PATH:-./downloads}:/downloads
      - ${TRANSMISSION_WATCH_PATH:-./watch}:/watch
    ports:
      - "${TRANSMISSION_WEB_PORT:-9091}:9091"
      - "${TRANSMISSION_PEER_PORT:-51413}:51413"
      - "${TRANSMISSION_PEER_PORT:-51413}:51413/udp"
    restart: ${RESTART_POLICY:-unless-stopped}

  telegram-bot:
    build: ./bot
    container_name: telegram-bot
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - ALLOWED_USER_IDS=${ALLOWED_USER_IDS}
      - TRANSMISSION_HOST=${TRANSMISSION_HOST:-transmission}
      - TRANSMISSION_PORT=${TRANSMISSION_PORT:-9091}
      - TRANSMISSION_USER=${TRANSMISSION_USER}
      - TRANSMISSION_PASS=${TRANSMISSION_PASS}
      - CHECK_INTERVAL=${CHECK_INTERVAL:-60}
      - MAX_TORRENTS_DISPLAY=${MAX_TORRENTS_DISPLAY:-10}
      - TZ=${TZ:-Europe/Moscow}
      - EMOJI_DOWNLOADING=${EMOJI_DOWNLOADING:-‚¨áÔ∏è}
      - EMOJI_SEEDING=${EMOJI_SEEDING:-‚úÖ}
      - EMOJI_PAUSED=${EMOJI_PAUSED:-‚è∏Ô∏è}
      - EMOJI_ERROR=${EMOJI_ERROR:-‚ùå}
      - EMOJI_COMPLETED=${EMOJI_COMPLETED:-üéâ}
      - WELCOME_MESSAGE=${WELCOME_MESSAGE}
      - HELP_MESSAGE=${HELP_MESSAGE}
      - EMPTY_LIST_MESSAGE=${EMPTY_LIST_MESSAGE}
      - LIST_HEADER=${LIST_HEADER}
      - ERROR_MESSAGE=${ERROR_MESSAGE}
      - TORRENT_ADDED_MESSAGE=${TORRENT_ADDED_MESSAGE}
      - TORRENT_ADD_ERROR_MESSAGE=${TORRENT_ADD_ERROR_MESSAGE}
      - COMPLETION_MESSAGE=${COMPLETION_MESSAGE}
    depends_on:
      - transmission
    restart: ${RESTART_POLICY:-unless-stopped}
